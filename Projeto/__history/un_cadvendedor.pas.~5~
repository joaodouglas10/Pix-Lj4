unit un_cadvendedor;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.Grids, Vcl.DBGrids, Vcl.StdCtrls,
  Vcl.Mask, Vcl.DBCtrls, Vcl.Buttons, Vcl.ExtCtrls;

type
  Tfrm_vendedor = class(TForm)
    Label1: TLabel;
    cod: TDBEdit;
    Label2: TLabel;
    nome: TDBEdit;
    DBGrid1: TDBGrid;
    Panel1: TPanel;
    novo: TSpeedButton;
    editar: TSpeedButton;
    excluir: TSpeedButton;
    gravar: TSpeedButton;
    cancelar: TSpeedButton;
    sair: TSpeedButton;
    procedure novoClick(Sender: TObject);
    procedure editarClick(Sender: TObject);
    procedure excluirClick(Sender: TObject);
    procedure gravarClick(Sender: TObject);
    procedure cancelarClick(Sender: TObject);
    procedure sairClick(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure FormKeyPress(Sender: TObject; var Key: Char);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frm_vendedor: Tfrm_vendedor;

implementation

{$R *.dfm}

uses un_entrega;

procedure Tfrm_vendedor.cancelarClick(Sender: TObject);
begin
    If Application.Messagebox('Confirma Cancelamento de Vendedor? ', 'Confirmação',
    mb_Iconquestion + Mb_OkCancel + Mb_DefButton1) = IdOk then
    else
    exit;
    cod.ReadOnly := true;
    nome.ReadOnly := true;
    novo.Enabled := true;
    editar.Enabled := true;
    excluir.Enabled := true;
    cancelar.Enabled := false;
    gravar.Enabled := false;
    sair.Enabled := true;
    Dtm_Entrega.qry_vendedor.Cancel;
    cod.setfocus;
end;

procedure Tfrm_vendedor.editarClick(Sender: TObject);
begin
    If Application.Messagebox('Confirma Alteração de Vendedor? ', 'Confirmação',
    mb_Iconquestion + Mb_OkCancel + Mb_DefButton1) = IdOk then
    else
    exit;
    cod.ReadOnly := false;
    nome.ReadOnly := false;
    novo.Enabled := false;
    editar.Enabled := false;
    excluir.Enabled := false;
    cancelar.Enabled := true;
    gravar.Enabled := true;
    sair.Enabled := false;
    Dtm_Entrega.qry_vendedor.Edit;
    cod.setfocus;
end;

procedure Tfrm_vendedor.excluirClick(Sender: TObject);
begin
   If Dtm_Entrega.qry_vendedor.RecordCount <> 0 then
   If Application.Messagebox('Confirma Exclusão?', 'Confirmar',
      mb_Iconquestion + MB_YesNo + Mb_DefButton1) = IdYes Then
      begin
         Dtm_Entrega.qry_vendedor.Delete;
         cod.setfocus;
      end;
      If Dtm_Entrega.qry_vendedor.RecordCount = 0 then
         showmessage('Nao Existe Registro para Excluir');
end;

procedure Tfrm_vendedor.FormKeyPress(Sender: TObject; var Key: Char);
begin
   If Key=#13 Then
      Selectnext(ActiveControl,True,True);
end;

procedure Tfrm_vendedor.FormShow(Sender: TObject);
begin
   Dtm_Entrega.qry_vendedor.Open;
end;

procedure Tfrm_vendedor.gravarClick(Sender: TObject);
begin
    If Application.Messagebox('Confirma Gravação de Vendedor? ', 'Confirmação',
    mb_Iconquestion + Mb_OkCancel + Mb_DefButton1) = IdOk then
    else
    exit;
    cod.ReadOnly := true;
    nome.ReadOnly := true;
    novo.Enabled := true;
    editar.Enabled := true;
    excluir.Enabled := true;
    cancelar.Enabled := false;
    gravar.Enabled := false;
    sair.Enabled := true;
    Dtm_Entrega.qry_vendedor.Post;
    cod.setfocus;
end;

procedure Tfrm_vendedor.novoClick(Sender: TObject);
begin
    If Application.Messagebox('Confirma Inclusão de Vendedor? ', 'Confirmação',
    mb_Iconquestion + Mb_OkCancel + Mb_DefButton1) = IdOk then
    else
    exit;
    cod.ReadOnly := false;
    nome.ReadOnly := false;
    novo.Enabled := false;
    editar.Enabled := false;
    excluir.Enabled := false;
    cancelar.Enabled := true;
    gravar.Enabled := true;
    sair.Enabled := false;
    Dtm_Entrega.qry_vendedor.Append;
    cod.setfocus;
end;

procedure Tfrm_vendedor.sairClick(Sender: TObject);
begin
   Dtm_Entrega.qry_vendedor.Close;
   Close;
end;

end.
